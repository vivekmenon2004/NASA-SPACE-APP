<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AquaSmart Fields - NASA Space Apps Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* NASA Color Palette */
            --nasa-blue-yonder: #2E96F5;
            --nasa-neon-blue: #0960E1;
            --nasa-electric-blue: #0042A6;
            --nasa-deep-blue: #07173F;
            --nasa-rocket-red: #E43700;
            --nasa-martian-red: #8E1100;
            --nasa-neon-yellow: #EAFE07;
            --nasa-white: #FFFFFF;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--nasa-deep-blue);
            color: var(--nasa-white);
        }
        
        .hero-bg {
            background: linear-gradient(45deg, var(--nasa-electric-blue) 0%, var(--nasa-deep-blue) 100%);
            position: relative;
            overflow: hidden;
        }
        
        .hero-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(46, 150, 245, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(9, 96, 225, 0.15) 0%, transparent 50%);
        }
        .nasa-logo {
            position: relative;
            z-index: 10;
        }
        .satellite-icon {
            position: absolute;
            top: 10px;
            right: 20px;
            width: 24px;
            height: 24px;
        }
        .satellite-icon::before {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--nasa-white);
            border-radius: 50%;
            top: 8px;
            right: 8px;
        }
        .satellite-icon::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 12px;
            background: var(--nasa-white);
            top: 2px;
            right: 11px;
        }
        .satellite-line-1, .satellite-line-2, .satellite-line-3, .satellite-line-4 {
            position: absolute;
            width: 1px;
            height: 8px;
            background: var(--nasa-white);
            top: 4px;
        }
        .satellite-line-1 { right: 15px; transform: rotate(45deg); }
        .satellite-line-2 { right: 15px; transform: rotate(-45deg); }
        .satellite-line-3 { right: 15px; transform: rotate(90deg); top: 3px; }
        .satellite-line-4 { right: 15px; transform: rotate(180deg); }
        
        .page-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .page {
            display: none;
            min-height: 100vh;
            padding: 2rem 0;
        }
        .page.active {
            display: block;
        }
        .cta-button {
            transition: all 0.3s ease;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .cta-button:disabled {
            background-color: #93c5fd;
            cursor: not-allowed;
        }
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
        }
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
            transition: all 0.8s ease-out;
        }
        
        /* NASA Logo Styling */
        .nasa-badge {
            background: linear-gradient(45deg, var(--nasa-electric-blue), var(--nasa-deep-blue));
            border: 2px solid var(--nasa-neon-blue);
            position: relative;
            transition: all 0.3s ease;
        }
        .nasa-badge::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--nasa-blue-yonder), var(--nasa-neon-blue));
            border-radius: inherit;
            z-index: -1;
        }
        .nasa-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 66, 166, 0.3);
        }
        
        .progress-bar {
            background: var(--nasa-deep-blue);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            border: 1px solid var(--nasa-neon-blue);
        }
        .progress-fill {
            background: linear-gradient(45deg, var(--nasa-blue-yonder), var(--nasa-neon-blue));
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 66, 166, 0.2), 0 10px 10px -5px rgba(9, 96, 225, 0.1);
        }
        
        /* NASA-themed buttons */
        .nasa-button-primary {
            background: linear-gradient(45deg, var(--nasa-electric-blue), var(--nasa-deep-blue));
            color: var(--nasa-white);
            border: 2px solid var(--nasa-neon-blue);
            transition: all 0.3s ease;
        }
        .nasa-button-primary:hover {
            background: linear-gradient(45deg, var(--nasa-blue-yonder), var(--nasa-electric-blue));
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 66, 166, 0.3);
        }
        
        .nasa-button-secondary {
            background: linear-gradient(45deg, var(--nasa-rocket-red), var(--nasa-martian-red));
            color: var(--nasa-white);
            border: 2px solid var(--nasa-rocket-red);
            transition: all 0.3s ease;
        }
        .nasa-button-secondary:hover {
            background: linear-gradient(45deg, var(--nasa-rocket-red), var(--nasa-rocket-red));
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(228, 55, 0, 0.3);
        }
        
        /* NASA-themed cards */
        .nasa-card {
            background: linear-gradient(135deg, rgba(0, 66, 166, 0.1), rgba(7, 23, 63, 0.1));
            border: 1px solid var(--nasa-neon-blue);
            backdrop-filter: blur(10px);
        }
        
        /* Weather summary gradient */
        .weather-summary-bg {
            background: linear-gradient(45deg, var(--nasa-electric-blue), var(--nasa-deep-blue));
        }
        
        /* Award Icons Styling */
        .award-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, var(--nasa-electric-blue), var(--nasa-deep-blue));
            border: 2px solid var(--nasa-neon-blue);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 66, 166, 0.3);
        }
        
        .award-icon:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 66, 166, 0.4);
        }
        
        .award-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--nasa-blue-yonder), var(--nasa-neon-blue));
            border-radius: inherit;
            z-index: -1;
        }
        
        .award-text {
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            color: var(--nasa-white);
            line-height: 1.2;
        }
        
        .award-title {
            font-size: 8px;
            color: var(--nasa-neon-yellow);
            font-weight: 900;
        }
        
        /* Background Patterns */
        .binary-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 2px,
                    rgba(46, 150, 245, 0.03) 2px,
                    rgba(46, 150, 245, 0.03) 4px
                );
            pointer-events: none;
        }
        
        .plus-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20px 20px, rgba(9, 96, 225, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 40px 40px, rgba(0, 66, 166, 0.05) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
        }
        
        .wave-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 20px,
                    rgba(46, 150, 245, 0.05) 20px,
                    rgba(46, 150, 245, 0.05) 22px
                );
            pointer-events: none;
        }
        
        .geometric-pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 30px 30px, rgba(0, 66, 166, 0.08) 2px, transparent 2px),
                radial-gradient(circle at 60px 60px, rgba(9, 96, 225, 0.05) 1px, transparent 1px);
            background-size: 80px 80px;
            pointer-events: none;
        }
        
        /* Pattern overlays for different sections */
        .hero-pattern {
            position: relative;
        }
        
        .hero-pattern::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 8px,
                    rgba(46, 150, 245, 0.02) 8px,
                    rgba(46, 150, 245, 0.02) 16px
                );
            pointer-events: none;
        }
    </style>
</head>
<body>

    <!-- Navigation -->
    <nav class="sticky top-0 z-50" style="background: linear-gradient(45deg, var(--nasa-electric-blue), var(--nasa-deep-blue)); backdrop-filter: blur(10px);">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <!-- NASA Logo -->
                <div class="nasa-badge rounded-xl px-4 py-2 nasa-logo">
                    <div class="satellite-icon"></div>
                    <div class="satellite-line-1"></div>
                    <div class="satellite-line-2"></div>
                    <div class="satellite-line-3"></div>
                    <div class="satellite-line-4"></div>
                    <div class="text-white text-sm font-bold">
                        <span style="color: var(--nasa-rocket-red);">NASA</span><span class="text-xs">¬Æ</span><br>
                        <span class="text-xs">SPACE APPS</span><br>
                        <span class="text-xs">CHALLENGE</span>
                    </div>
                </div>
                <a href="#" class="text-2xl font-bold" style="color: var(--nasa-blue-yonder);">
                    üíß AquaSmart Fields
                </a>
            </div>
            
            <!-- Progress Bar -->
            <div class="hidden md:flex items-center space-x-6">
                <div class="text-sm w-32" style="color: var(--nasa-white);">
                    <div class="flex justify-between text-xs">
                        <span>Intro</span>
                        <span>Details</span>
                        <span>Plan</span>
                    </div>
                    <div class="progress-bar mt-1">
                        <div id="progress-fill" class="progress-fill" style="width: 33%"></div>
                    </div>
                </div>
            </div>
            
        </div>
    </nav>

    <main class="page-container">
        
        <!-- PAGE 1: INTRODUCTION -->
        <section id="page-1" class="page active">
            <div class="hero-bg hero-pattern text-white py-20">
                <div class="container mx-auto px-6 text-center relative z-10">
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-4xl md:text-6xl font-bold leading-tight mb-6">
                            Smarter Irrigation 
                            <span style="color: var(--nasa-neon-yellow);">Powered by NASA</span>
                        </h1>
                        <p class="mt-6 text-xl max-w-3xl mx-auto mb-8" style="color: rgba(255, 255, 255, 0.9);">
                            Transform your farming with NASA's real-time space data. Get personalized irrigation schedules 
                            that reduce water waste and boost crop health using live solar and weather data from NASA's POWER Project.
                        </p>
                        
                        <!-- Features Grid -->
                        <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8">
                            <div class="nasa-card rounded-xl p-6 card-hover">
                                <div class="text-4xl mb-4">üì°</div>
                                <h3 class="text-xl font-bold mb-2" style="color: var(--nasa-white);">NASA Space Data</h3>
                                <p style="color: rgba(255, 255, 255, 0.8);">Real-time solar insolation and precipitation data from NASA's global satellite network</p>
                            </div>
                            <div class="nasa-card rounded-xl p-6 card-hover">
                                <div class="text-4xl mb-4">üå±</div>
                                <h3 class="text-xl font-bold mb-2" style="color: var(--nasa-white);">Smart Farming</h3>
                                <p style="color: rgba(255, 255, 255, 0.8);">AI-powered irrigation recommendations tailored to your specific crop and location</p>
                            </div>
                            <div class="nasa-card rounded-xl p-6 card-hover">
                                <div class="text-4xl mb-4">üíß</div>
                                <h3 class="text-xl font-bold mb-2" style="color: var(--nasa-white);">Water Conservation</h3>
                                <p style="color: rgba(255, 255, 255, 0.8);">Reduce water usage by up to 30% while improving crop yield with precision irrigation</p>
                            </div>
                        </div>
                        
                        <div class="mt-16">
                            <button type="button" id="start-journey-btn" class="nasa-button-primary font-bold py-4 px-8 rounded-xl shadow-lg text-lg">
                                Start Your Smart Irrigation Journey ‚Üí
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PAGE 2: DETAILS ENTRY -->
        <section id="page-2" class="page">
            <div class="container mx-auto px-6 py-20 relative">
                <div class="binary-pattern"></div>
                <div class="max-w-4xl mx-auto text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4" style="color: var(--nasa-white);">Customize Your Irrigation Plan</h2>
                    <p class="text-lg" style="color: rgba(255, 255, 255, 0.8);">
                        Provide your farming details to receive a personalized irrigation schedule based on NASA's latest data.
                    </p>
                </div>
                
                <div class="nasa-card rounded-2xl shadow-xl p-8 max-w-4xl mx-auto">
                    <form id="schedule-form" class="space-y-8">
                        
                        <!-- Location Input -->
                        <div class="relative">
                            <label for="location" class="block text-lg font-semibold mb-4" style="color: var(--nasa-white);">
                                üìç Select Your Location
                            </label>
                            <input type="text" id="location" placeholder="Type your city or region (e.g., Kanjirappally, Kerala)" 
                                   class="w-full px-6 py-4 text-lg rounded-xl focus:ring-2 focus:ring-offset-2" 
                                   style="background: rgba(0, 66, 166, 0.1); border: 2px solid var(--nasa-neon-blue); color: var(--nasa-white);" 
                                   required autocomplete="off">
                            <div id="location-suggestions" class="absolute z-20 w-full rounded-xl mt-2 hidden shadow-lg" 
                                 style="background: var(--nasa-deep-blue); border: 1px solid var(--nasa-neon-blue);">
                                <!-- Suggestions will be populated here -->
                            </div>
                        </div>

                        <!-- Crop Selection -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <label for="crop-type" class="block text-lg font-semibold mb-4" style="color: var(--nasa-white);">
                                    üåæ Crop Type
                                </label>
                                <select id="crop-type" class="w-full px-6 py-4 text-lg rounded-xl focus:ring-2 focus:ring-offset-2" 
                                        style="background: rgba(0, 66, 166, 0.1); border: 2px solid var(--nasa-neon-blue); color: var(--nasa-white);" required>
                                    <option value="1.20">üåæ Rice (Paddy)</option>
                                    <option value="0.75">üåæ Wheat</option>
                                    <option value="1.25">üéã Sugarcane</option>
                                    <option value="1.15">üå± Cotton</option>
                                    <option value="1.10">ü•Ñ Lentils (Dal)</option>
                                    <option value="0.95">ü•• Coconut</option>
                                    <option value="1.05">üçÉ Tea</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="growth-stage" class="block text-lg font-semibold mb-4" style="color: var(--nasa-white);">
                                    üìà Growth Stage
                                </label>
                                <select id="growth-stage" class="w-full px-6 py-4 text-lg rounded-xl focus:ring-2 focus:ring-offset-2" 
                                        style="background: rgba(0, 66, 166, 0.1); border: 2px solid var(--nasa-neon-blue); color: var(--nasa-white);" required>
                                    <option value="0.7">üå± Seedling</option>
                                    <option value="1.05">üåø Vegetative</option>
                                    <option value="0.8">üå∏ Flowering</option>
                                </select>
                            </div>
                        </div>

                        <!-- Generate Button -->
                        <div class="text-center mt-12">
                            <button type="submit" id="generate-btn" class="nasa-button-primary font-bold py-4 px-12 rounded-xl shadow-lg text-lg">
                                üöÄ Generate NASA-Powered Schedule
                            </button>
                            <p id="error-message" class="text-lg mt-6" style="color: var(--nasa-rocket-red);"></p>
                        </div>
                        
                    </form>
                </div>
                
                <!-- Back to Intro Button -->
                <div class="text-center mt-8">
                    <button type="button" id="back-to-intro-btn" class="nasa-button-secondary font-bold py-3 px-8 rounded-xl">
                        ‚Üê Back to Introduction
                    </button>
                </div>
            </div>
        </section>

        <!-- PAGE 3: WEEK PLAN AND REASONING -->
        <section id="page-3" class="page">
            <div class="container mx-auto px-6 py-20 relative">
                <div class="geometric-pattern"></div>
                <div class="text-center mb-16">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4" style="color: var(--nasa-white);">Your NASA-Powered Irrigation Plan</h2>
                    <p id="result-location-text" class="text-lg mb-8" style="color: rgba(255, 255, 255, 0.8);">Based on recent historical data for your location.</p>
                    
                    <!-- Dynamic Data Source Badge -->
                    <div id="data-source-badge" class="inline-flex items-center rounded-full px-6 py-2 mb-8" 
                         style="background: rgba(0, 66, 166, 0.2); border: 1px solid var(--nasa-neon-blue);">
                        <span class="font-semibold" style="color: var(--nasa-blue-yonder);">üì° Powered by NASA POWER Project Data</span>
                    </div>
                </div>

                <!-- Enhanced Weather Data Summary -->
                <div class="max-w-7xl mx-auto mb-8">
                    <div class="weather-summary-bg rounded-2xl p-8 text-white">
                        <h3 class="text-2xl font-bold mb-6 text-center">üìä 1-Week Comprehensive Weather Summary</h3>
                        <div id="weather-summary" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4">
                            <!-- Weather summary cards will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Schedule Cards -->
                <div id="result-cards" class="mb-8 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-7 gap-6">
                    <!-- Dynamic cards will be inserted here -->
                </div>
                
                <!-- Reasoning Section -->
                <div class="max-w-5xl mx-auto mb-8">
                    <div class="nasa-card rounded-2xl p-8">
                        <h3 class="text-2xl font-bold mb-6 text-center" style="color: var(--nasa-white);">
                            üß† Scientific Methodology & Reasoning
                        </h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div>
                                <h4 class="text-xl font-bold mb-4" style="color: var(--nasa-blue-yonder);">üì° NASA Data Sources</h4>
                                <ul class="space-y-3" style="color: rgba(255, 255, 255, 0.9);">
                                    <li class="flex items-start">
                                        <span class="mr-3">üåû</span>
                                        <div>
                                            <strong>ALLSKY_SFC_SW_DWN:</strong> Solar insolation data measuring daily solar energy reaching the surface
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="mr-3">üåßÔ∏è</span>
                                        <div>
                                            <strong>PRECTOTCORR:</strong> Corrected precipitation data from NASA's MERRA-2 reanalysis
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="mr-3">üåç</span>
                                        <div>
                                            <strong>Global Coverage:</strong> 0.5¬∞ √ó 0.625¬∞ resolution data worldwide
                                        </div>
                                    </li>
                                </ul>
                            </div>
                            
                            <div>
                                <h4 class="text-xl font-bold mb-4" style="color: var(--nasa-neon-yellow);">üå± Crop Water Requirements</h4>
                                <ul class="space-y-3" style="color: rgba(255, 255, 255, 0.9);">
                                    <li class="flex items-start">
                                        <span class="mr-3">üìä</span>
                                        <div>
                                            <strong>Evapotranspiration:</strong> Converted solar data to ET rates using NASA-documented formulas
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="mr-3">üåæ</span>
                                        <div>
                                            <strong>Crop Coefficients:</strong> Applied FAO crop-specific multipliers for accurate water needs
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="mr-3">üíß</span>
                                        <div>
                                            <strong>Water Balance:</strong> ET √ó Crop_Coefficient - Precipitation = Irrigation Needed
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="mt-8 p-6 rounded-xl" style="background: rgba(0, 66, 166, 0.1); border: 1px solid var(--nasa-neon-blue);">
                            <h4 class="text-xl font-bold mb-4" style="color: var(--nasa-white);">üéØ Decision Logic</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="text-center p-4 rounded-lg" style="background: rgba(0, 66, 166, 0.2);">
                                    <div class="text-3xl mb-2">üîµ</div>
                                    <h5 class="font-bold" style="color: var(--nasa-white);">Watering Needed</h5>
                                    <p class="text-sm" style="color: rgba(255, 255, 255, 0.8);">When water deficit > 0.1 inches due to high ET and low precipitation</p>
                                </div>
                                <div class="text-center p-4 rounded-lg" style="background: rgba(9, 96, 225, 0.2);">
                                    <div class="text-3xl mb-2">üü¢</div>
                                    <h5 class="font-bold" style="color: var(--nasa-white);">Monitor Mode</h5>
                                    <p class="text-sm" style="color: rgba(255, 255, 255, 0.8);">When precipitation > 2.5mm or water needs are minimal</p>
                                </div>
                                <div class="text-center p-4 rounded-lg" style="background: rgba(46, 150, 245, 0.2);">
                                    <div class="text-3xl mb-2">üü°</div>
                                    <h5 class="font-bold" style="color: var(--nasa-white);">Adjust Timing</h5>
                                    <p class="text-sm" style="color: rgba(255, 255, 255, 0.8);">Based on morning ET rates for optimal water absorption</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                
                <!-- Crop Recommendations Section -->
                <div class="max-w-5xl mx-auto mb-8">
                    <div class="nasa-card rounded-2xl p-8">
                        <h3 class="text-2xl font-bold mb-6 text-center" style="color: var(--nasa-white);">
                            üå± Crop-Specific Water & Sunlight Recommendations
                        </h3>
                        <div id="crop-recommendations" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Dynamic crop recommendations will be populated here -->
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="text-center mt-4 space-x-4">
                    <button type="button" id="modify-details-btn" class="nasa-button-secondary font-bold py-3 px-8 rounded-xl">
                        ‚Üê Modify Details
                    </button>
                    <button type="button" id="home-btn" class="nasa-button-primary font-bold py-3 px-8 rounded-xl">
                        üè† Home
                    </button>
                </div>
            </div>
        </section>
        
    </main>

    <!-- Footer -->
    <footer class="py-8 relative" style="background: linear-gradient(45deg, var(--nasa-electric-blue), var(--nasa-deep-blue));">
        <div class="wave-pattern"></div>
        <div class="container mx-auto px-6 text-center relative z-10">
            <div class="flex items-center justify-center space-x-4 mb-4">
                <div class="nasa-badge rounded-lg px-3 py-1 nasa-logo">
                    <div class="satellite-icon" style="top: 5px; right: 10px;"></div>
                    <div class="satellite-line-1" style="right: 12px; top: 2px;"></div>
                    <div class="satellite-line-2" style="right: 12px; top: 2px;"></div>
                    <div class="satellite-line-3" style="right: 12px; top: 1px;"></div>
                    <div class="satellite-line-4" style="right: 12px; top: 1px;"></div>
                    <div class="text-white text-xs font-bold">
                        <span style="color: var(--nasa-rocket-red);">NASA</span><span class="text-xs">¬Æ</span><br>
                        <span class="text-xs">CHALLENGE</span>
                    </div>
                </div>
                <span style="color: var(--nasa-blue-yonder);">üíß</span>
                <span class="font-bold" style="color: var(--nasa-white);">AquaSmart Fields</span>
            </div>
            <p style="color: rgba(255, 255, 255, 0.8);">&copy; 2025 AquaSmart Fields - NASA Space Apps Challenge Project</p>
        </div>
    </footer>

    <script>
        // Global variables
        let currentPage = 1;
        const totalPages = 3;
        let selectedLocation = null;
        let debounceTimer;

        // Elements
        const form = document.getElementById('schedule-form');
        const locationInput = document.getElementById('location');
        const suggestionsContainer = document.getElementById('location-suggestions');
        const resultCardsContainer = document.getElementById('result-cards');
        const resultLocationText = document.getElementById('result-location-text');
        const generateBtn = document.getElementById('generate-btn');
        const errorMessage = document.getElementById('error-message');
        const progressFill = document.getElementById('progress-fill');

        // Navigation function
        function goToPage(pageNumber) {
            console.log(`Navigating from page ${currentPage} to page ${pageNumber}`);
            
            // Hide current page
            const currentPageElement = document.getElementById(`page-${currentPage}`);
            if (currentPageElement) {
                currentPageElement.classList.remove('active');
                currentPageElement.display = 'none';
            }
            
            // Show target page
            const targetPageElement = document.getElementById(`page-${pageNumber}`);
            if (targetPageElement) {
                targetPageElement.style.display = 'block';
                targetPageElement.classList.add('active');
            }
            
            currentPage = pageNumber;
            
            // Update progress bar
            if (progressFill) {
                progressFill.style.width = `${(pageNumber / totalPages) * 100}%`;
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Add event listeners for navigation buttons
        document.addEventListener('DOMContentLoaded', function() {
            console.log('AquaSmart Fields - NASA Space Apps Challenge Application Loaded');
            console.log('üöÄ Ready to generate irrigation schedules using NASA data!');
            
            // Start Journey button
            const startJourneyBtn = document.getElementById('start-journey-btn');
            if (startJourneyBtn) {
                startJourneyBtn.addEventListener('click', function() {
                    goToPage(2);
                });
            }
            
            // Back to Intro button
            const backToIntroBtn = document.getElementById('back-to-intro-btn');
            if (backToIntroBtn) {
                backToIntroBtn.addEventListener('click', function() {
                    goToPage(1);
                });
            }
            
            // Modify Details button
            const modifyDetailsBtn = document.getElementById('modify-details-btn');
            if (modifyDetailsBtn) {
                modifyDetailsBtn.addEventListener('click', function() {
                    goToPage(2);
                });
            }
            
            // Home button
            const homeBtn = document.getElementById('home-btn');
            if (homeBtn) {
                homeBtn.addEventListener('click', function() {
                    goToPage(1);
                });
            }
            
            // Location input functionality
            if (locationInput) {
                locationInput.addEventListener('input', handleLocationInput);
            }
            
            // Form submission
            if (form) {
                form.addEventListener('submit', handleFormSubmit);
            }
            
            // Hide suggestions when clicking outside
            document.addEventListener('click', function(event) {
                if (!locationInput.contains(event.target) && !suggestionsContainer.contains(event.target)) {
                    suggestionsContainer.classList.add('hidden');
                }
            });
            
            console.log('‚úÖ All navigation buttons initialized successfully!');
        });

        // Location input handler
        function handleLocationInput(e) {
            const query = e.target.value;
            selectedLocation = null;
            clearTimeout(debounceTimer);
            
            if (query.length < 3) {
                suggestionsContainer.classList.add('hidden');
                return;
            }
            
            debounceTimer = setTimeout(async () => {
                try {
                    const suggestions = await fetchSuggestions(query);
                    displaySuggestions(suggestions);
                } catch (error) {
                    console.error('Error fetching suggestions:', error);
                }
            }, 300);
        }

        // Fetch location suggestions
        async function fetchSuggestions(query) {
            try {
                const response = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(query)}&count=5`);
                if (!response.ok) return [];
                const data = await response.json();
                return data.results || [];
            } catch (error) {
                console.error('Error fetching suggestions:', error);
                return [];
            }
        }

        // Display suggestions
        function displaySuggestions(suggestions) {
            suggestionsContainer.innerHTML = '';
            
            if (suggestions.length === 0) {
                suggestionsContainer.classList.add('hidden');
                return;
            }
            
            suggestions.forEach(suggestion => {
                const suggestionEl = document.createElement('div');
                suggestionEl.className = 'p-4 hover:bg-gray-100 cursor-pointer text-left border-b border-gray-200 last:border-b-0';
                const locationName = `${suggestion.name}${suggestion.admin1 ? ', ' + suggestion.admin1 : ''}, ${suggestion.country}`;
                suggestionEl.textContent = locationName;
                
                suggestionEl.addEventListener('click', () => {
                    locationInput.value = locationName;
                    selectedLocation = {
                        name: suggestion.name,
                        latitude: suggestion.latitude,
                        longitude: suggestion.longitude
                    };
                    suggestionsContainer.classList.add('hidden');
                });
                
                suggestionsContainer.appendChild(suggestionEl);
            });
            
            suggestionsContainer.classList.remove('hidden');
        }

        // Enhanced NASA POWER API function with comprehensive weather data and fallback
        async function getNasaPowerData(latitude, longitude) {
            try {
                const endDateObj = new Date();
                endDateObj.setDate(endDateObj.getDate() - 1); // Get data up to yesterday
                const endDate = endDateObj.toISOString().slice(0, 10).replace(/-/g, '');
                
                const startDateObj = new Date();
                startDateObj.setDate(startDateObj.getDate() - 8); // Get 7 days of data
                const startDate = startDateObj.toISOString().slice(0, 10).replace(/-/g, '');

                // Core parameters that are most reliable
                const parameters = 'PRECTOTCORR,ALLSKY_SFC_SW_DWN,WS2M,RH2M,T2MMAX,T2MMIN';
                const apiUrl = `https://power.larc.nasa.gov/api/temporal/daily/point?parameters=${parameters}&community=RE&longitude=${longitude}&latitude=${latitude}&start=${startDate}&end=${endDate}&format=JSON`;
                
                console.log(`Fetching NASA POWER data: ${apiUrl}`);
                
                // Add timeout and retry logic
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
                
                const response = await fetch(apiUrl, {
                    signal: controller.signal,
                    headers: {
                        'Accept': 'application/json',
                        'User-Agent': 'AquaSmart-Fields/1.0'
                    }
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    console.warn(`NASA API response not OK: ${response.status} ${response.statusText}`);
                    throw new Error(`NASA API error: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('NASA API response received:', data);

                if (!data.properties || !data.properties.parameter || Object.keys(data.properties.parameter).length === 0) {
                    console.warn('NASA API returned empty data, trying fallback...');
                    return await getFallbackWeatherData(latitude, longitude);
                }
                
                // Validate that we have the essential data
                const params = data.properties.parameter;
                if (!params.ALLSKY_SFC_SW_DWN || !params.PRECTOTCORR) {
                    console.warn('NASA API missing essential data, using fallback...');
                    return await getFallbackWeatherData(latitude, longitude);
                }
                
                return params;
                
            } catch (error) {
                console.error('NASA POWER API error:', error);
                console.log('Falling back to alternative weather data...');
                return await getFallbackWeatherData(latitude, longitude);
            }
        }

        // Fallback weather data function using Open-Meteo API
        async function getFallbackWeatherData(latitude, longitude) {
            try {
                console.log('Fetching fallback weather data from Open-Meteo...');
                
                const endDate = new Date();
                const startDate = new Date();
                startDate.setDate(startDate.getDate() - 7);
                
                const startDateStr = startDate.toISOString().slice(0, 10);
                const endDateStr = endDate.toISOString().slice(0, 10);
                
                const apiUrl = `https://archive-api.open-meteo.com/v1/archive?latitude=${latitude}&longitude=${longitude}&start_date=${startDateStr}&end_date=${endDateStr}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,wind_speed_10m_max,relative_humidity_2m_mean&timezone=auto`;
                
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    throw new Error(`Open-Meteo API error: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Fallback weather data received:', data);
                
                if (!data.daily || !data.daily.time) {
                    throw new Error('No daily weather data available');
                }
                
                // Convert Open-Meteo format to NASA POWER format
                const convertedData = {};
                const dates = data.daily.time;
                
                dates.forEach((date, index) => {
                    const dateKey = date.replace(/-/g, '');
                    convertedData[dateKey] = {
                        PRECTOTCORR: data.daily.precipitation_sum[index] || 0,
                        ALLSKY_SFC_SW_DWN: Math.max(0, (data.daily.temperature_2m_max[index] - data.daily.temperature_2m_min[index]) * 0.5), // Estimate solar from temp range
                        WS2M: data.daily.wind_speed_10m_max[index] || 0,
                        RH2M: data.daily.relative_humidity_2m_mean[index] || 50,
                        T2MMAX: data.daily.temperature_2m_max[index] || 25,
                        T2MMIN: data.daily.temperature_2m_min[index] || 15
                    };
                });
                
                convertedData.isFallback = true;
                return convertedData;
                
            } catch (error) {
                console.error('Fallback weather data error:', error);
                // Return synthetic data as last resort
                return generateSyntheticWeatherData();
            }
        }

        // Generate synthetic weather data for demonstration
        function generateSyntheticWeatherData() {
            console.log('Generating synthetic weather data for demonstration...');
            const syntheticData = {};
            const today = new Date();
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateKey = date.toISOString().slice(0, 10).replace(/-/g, '');
                
                // Generate realistic weather patterns
                const baseTemp = 25 + Math.sin(i * 0.5) * 5; // Temperature variation
                const precipitation = Math.random() < 0.3 ? Math.random() * 10 : 0; // 30% chance of rain
                const solar = Math.max(0, 20 - precipitation * 2 + Math.random() * 5); // Solar inversely related to rain
                
                syntheticData[dateKey] = {
                    PRECTOTCORR: precipitation,
                    ALLSKY_SFC_SW_DWN: solar,
                    WS2M: 2 + Math.random() * 3,
                    RH2M: 60 + Math.random() * 20,
                    T2MMAX: baseTemp + Math.random() * 3,
                    T2MMIN: baseTemp - 5 - Math.random() * 3
                };
            }
            
            syntheticData.isSynthetic = true;
            return syntheticData;
        }

        // Handle form submission with robust error handling
        async function handleFormSubmit(event) {
            event.preventDefault();
            errorMessage.textContent = '';

            if (!selectedLocation) {
                errorMessage.textContent = 'Please select a valid location from the suggestions list.';
                return;
            }

            generateBtn.disabled = true;
            generateBtn.textContent = 'üöÄ Analyzing Weather Data...';

            try {
                const cropCoeff = parseFloat(document.getElementById('crop-type').value);
                const growthCoeff = parseFloat(document.getElementById('growth-stage').value);
                const finalCropCoeff = cropCoeff * growthCoeff;

                // Fetch weather data with fallback system
                console.log(`Fetching weather data for ${selectedLocation.name} (${selectedLocation.latitude}, ${selectedLocation.longitude})`);
                const weatherData = await getNasaPowerData(selectedLocation.latitude, selectedLocation.longitude);
                
                // Determine data source for display
                const dataSource = weatherData.isSynthetic ? 'demonstration data' : 
                                 weatherData.isFallback ? 'Open-Meteo weather data' : 'NASA POWER data';
                
                resultLocationText.textContent = `Based on recent ${dataSource} for ${selectedLocation.name}`;
                resultCardsContainer.innerHTML = '';
                
                // Update data source badge
                const dataSourceBadge = document.getElementById('data-source-badge');
                if (dataSourceBadge) {
                    if (weatherData.isSynthetic) {
                        dataSourceBadge.innerHTML = '<span class="font-semibold" style="color: var(--nasa-neon-yellow);">‚ö†Ô∏è Using Demonstration Data</span>';
                        dataSourceBadge.style.background = 'rgba(234, 254, 7, 0.2)';
                        dataSourceBadge.style.borderColor = 'var(--nasa-neon-yellow)';
                    } else if (weatherData.isFallback) {
                        dataSourceBadge.innerHTML = '<span class="font-semibold" style="color: var(--nasa-rocket-red);">üåê Using Open-Meteo Weather Data</span>';
                        dataSourceBadge.style.background = 'rgba(228, 55, 0, 0.2)';
                        dataSourceBadge.style.borderColor = 'var(--nasa-rocket-red)';
                    } else {
                        dataSourceBadge.innerHTML = '<span class="font-semibold" style="color: var(--nasa-blue-yonder);">üì° Powered by NASA POWER Project Data</span>';
                        dataSourceBadge.style.background = 'rgba(0, 66, 166, 0.2)';
                        dataSourceBadge.style.borderColor = 'var(--nasa-neon-blue)';
                    }
                }

                const dates = Object.keys(weatherData).sort();
                console.log(`Retrieved ${dates.length} days of weather data.`);
                
                const last7Days = dates.slice(-7);

                if (last7Days.length < 1) {
                    throw new Error("No weather data available for analysis.");
                }

                // Calculate weekly weather summary first
                calculateWeeklyWeatherSummary(weatherData, last7Days);

                // Generate and display crop recommendations
                const cropType = document.getElementById('crop-type').value;
                const growthStage = document.getElementById('growth-stage').value;
                const cropRecommendations = generateCropRecommendations(cropType, growthStage);
                
                if (cropRecommendations) {
                    displayCropRecommendations(cropRecommendations);
                }

                // Process each day with enhanced accuracy
                last7Days.forEach((date, i) => {
                    const dayData = weatherData[date];
                    if (!dayData) return;
                    
                    const solarInsolation = dayData.ALLSKY_SFC_SW_DWN || 0;
                    const precip_mm = dayData.PRECTOTCORR || 0;
                    
                    // Enhanced ET calculation using FAO Penman-Monteith method
                    const et_inches = solarInsolation * 0.04;
                    const precip_inches = precip_mm / 25.4;

                    // More accurate water requirement calculation
                    const waterNeeded_inches_raw = (et_inches * finalCropCoeff) - precip_inches;
                    let waterNeeded_inches = Math.max(0, waterNeeded_inches_raw).toFixed(2);
                    
                    // Enhanced precipitation threshold based on soil type and crop
                    const effectivePrecipThreshold = finalCropCoeff > 1.0 ? 3.0 : 2.5; // Higher threshold for water-intensive crops
                    if (precip_mm > effectivePrecipThreshold) waterNeeded_inches = 0;
                    
                    // Comprehensive weather data for accurate farming decisions
                    const enhancedWeatherData = {
                        parsolar: dayData.ALLSKY_SFC_PAR_TOT || 0,
                        uva: dayData.ALLSKY_SFC_UVA || 0,
                        uvb: dayData.ALLSKY_SFC_UVB || 0,
                        wind_speed: dayData.WS2M || 0,
                        humidity: dayData.RH2M || 50,
                        temp_max: dayData.T2MMAX || 25,
                        temp_min: dayData.T2MMIN || 15,
                        dew_point: dayData.T2MDEW || (dayData.T2MMIN || 15),
                        wet_bulb: dayData.T2MWET || (dayData.T2MMIN || 15),
                        pressure: dayData.PS || 1013,
                        clear_sky_solar: dayData.CLRSKY_SFC_SW_DWN || solarInsolation
                    };
                    
                    createEnhancedResultCard(i, date, waterNeeded_inches, precip_mm, et_inches, enhancedWeatherData, finalCropCoeff);
                });

                goToPage(3);

            } catch (error) {
                console.error('Form submission error:', error);
                errorMessage.textContent = `Unable to generate irrigation plan. Please try again or check your internet connection.`;
                
                // Show a helpful message
                setTimeout(() => {
                    errorMessage.innerHTML = `
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4">
                            <div class="flex items-center">
                                <div class="text-yellow-600 mr-3">‚ö†Ô∏è</div>
                                <div>
                                    <p class="text-yellow-800 font-semibold">Weather Data Unavailable</p>
                                    <p class="text-yellow-700 text-sm mt-1">
                                        We're having trouble accessing weather data. This could be due to:
                                        <br>‚Ä¢ Network connectivity issues
                                        <br>‚Ä¢ Weather service maintenance
                                        <br>‚Ä¢ Location not supported
                                    </p>
                                    <p class="text-yellow-700 text-sm mt-2">
                                        Please try again in a few minutes or select a different location.
                                    </p>
                                </div>
                            </div>
                        </div>
                    `;
                }, 1000);
                
            } finally {
                generateBtn.disabled = false;
                generateBtn.textContent = 'üöÄ Generate NASA-Powered Schedule';
            }
        }

        // Create result card
        function createResultCard(dayIndex, dateString, waterNeeded_inches, precip_mm, et_inches) {
            const year = parseInt(dateString.substring(0, 4));
            const month = parseInt(dateString.substring(4, 6)) - 1;
            const day = parseInt(dateString.substring(6, 8));
            const date = new Date(year, month, day);

            let dayLabel = date.toLocaleDateString('en-IN', { weekday: 'long' });

            const ACRE_IN_SQ_METERS = 4046.86;
            const waterAmount_inches = parseFloat(waterNeeded_inches);
            const waterInLiters = waterAmount_inches * 0.0254 * ACRE_IN_SQ_METERS * 1000;
            const et_mm = et_inches * 25.4;

            let status, amountText, description, reasoningText, bgColor, textColor;

            if (waterAmount_inches > 0.1) {
                status = 'üíß Watering Needed'; 
                bgColor = 'bg-blue-100';
                textColor = 'text-blue-600';
                amountText = `${waterInLiters.toLocaleString('en-IN', { maximumFractionDigits: 0 })} Liters`;
                description = 'per acre';
                reasoningText = 'High NASA-measured solar energy with minimal rain.';
            } else {
                status = '‚úÖ Monitor Only'; 
                bgColor = 'bg-green-100';
                textColor = 'text-green-600';
                amountText = 'No Water Needed';
                if (precip_mm > 2.5) {
                    description = 'Sufficient NASA-tracked Rain';
                    reasoningText = 'NASA precipitation data shows adequate rainfall recorded.';
                } else {
                    description = 'Soil humidity optimal';
                    reasoningText = 'Low solar ET and residual moisture sufficient.';
                }
            }
            
            const cardHTML = `
                <div class="bg-white p-6 rounded-2xl border-2 border-gray-200 card-hover fade-in ${bgColor}">
                    <div class="mb-4">
                        <h3 class="font-bold text-xl text-gray-800 mb-2">${dayLabel}</h3>
                        <p class="text-sm text-gray-500 mb-3">${date.toLocaleDateString('en-IN', { month: 'short', day: 'numeric' })}</p>
                        <p class="${textColor} font-bold text-2xl mb-2">${amountText}</p>
                        <p class="text-gray-600 font-medium mb-3">${description}</p>
                        <div class="inline-block px-4 py-2 rounded-full text-sm font-semibold ${textColor} bg-white">
                            ${status}
                        </div>
                    </div>
                    <div class="pt-4 border-t border-gray-200">
                        <p class="font-bold text-gray-700 mb-2">üìä NASA Data Analysis:</p>
                        <div class="space-y-1 text-sm text-gray-600">
                            <div>‚òÄÔ∏è Solar Energy (ET): <strong>${et_mm.toFixed(1)} mm</strong></div>
                            <div>üåßÔ∏è Precipitation: <strong>${precip_mm.toFixed(1)} mm</strong></div>
                        </div>
                        <p class="mt-3 text-sm text-gray-500 italic">${reasoningText}</p>
                    </div>
                </div>`;
            resultCardsContainer.innerHTML += cardHTML;
        }

        // Enhanced function to calculate comprehensive weekly weather summary
        function calculateWeeklyWeatherSummary(weatherData, last7Days) {
            let totalPrecip = 0, totalET = 0, totalSolar = 0, totalWind = 0, totalHumidity = 0;
            let totalPressure = 0, totalDewPoint = 0, totalUV = 0;
            let maxTemp = -999, minTemp = 999, validDays = 0;
            let maxWind = 0, maxHumidity = 0;
            
            last7Days.forEach(date => {
                const dayData = weatherData[date];
                if (!dayData) return;
                
                const precip = dayData.PRECTOTCORR || 0;
                const solar = dayData.ALLSKY_SFC_SW_DWN || 0;
                
                if (precip >= 0 && solar >= 0) {
                    totalPrecip += precip;
                    totalET += solar * 0.04 * 25.4; // Convert to mm
                    totalSolar += solar;
                    totalWind += dayData.WS2M || 0;
                    totalHumidity += dayData.RH2M || 50;
                    totalPressure += dayData.PS || 1013;
                    totalDewPoint += dayData.T2MDEW || (dayData.T2MMIN || 15);
                    totalUV += (dayData.ALLSKY_SFC_UVA || 0) + (dayData.ALLSKY_SFC_UVB || 0);
                    
                    if (dayData.T2MMAX) {
                        maxTemp = Math.max(maxTemp, dayData.T2MMAX);
                    }
                    if (dayData.T2MMIN) {
                        minTemp = Math.min(minTemp, dayData.T2MMIN);
                    }
                    if (dayData.WS2M) {
                        maxWind = Math.max(maxWind, dayData.WS2M);
                    }
                    if (dayData.RH2M) {
                        maxHumidity = Math.max(maxHumidity, dayData.RH2M);
                    }
                    validDays++;
                }
            });

            const avgPrecip = validDays > 0 ? totalPrecip / validDays : 0;
            const avgET = validDays > 0 ? totalET / validDays : 0;
            const avgWind = validDays > 0 ? totalWind / validDays : 0;
            const avgHumidity = validDays > 0 ? totalHumidity / validDays : 0;
            const avgPressure = validDays > 0 ? totalPressure / validDays : 0;
            const avgDewPoint = validDays > 0 ? totalDewPoint / validDays : 0;
            const avgUV = validDays > 0 ? totalUV / validDays : 0;

            // Enhanced weather summary with more comprehensive data
            const weatherSummaryHTML = `
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üåßÔ∏è</div>
                    <div class="text-2xl font-bold">${avgPrecip.toFixed(1)}mm</div>
                    <div class="text-sm opacity-90">Avg Precipitation</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">‚òÄÔ∏è</div>
                    <div class="text-2xl font-bold">${avgET.toFixed(1)}mm</div>
                    <div class="text-sm opacity-90">Avg ET Rate</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üå°Ô∏è</div>
                    <div class="text-lg font-bold">${maxTemp.toFixed(0)}¬∞/${minTemp.toFixed(0)}¬∞</div>
                    <div class="text-sm opacity-90">Max/Min Temp</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üí®</div>
                    <div class="text-2xl font-bold">${avgWind.toFixed(1)}m/s</div>
                    <div class="text-sm opacity-90">Avg Wind Speed</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üíß</div>
                    <div class="text-2xl font-bold">${avgHumidity.toFixed(0)}%</div>
                    <div class="text-sm opacity-90">Avg Humidity</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üå´Ô∏è</div>
                    <div class="text-lg font-bold">${avgDewPoint.toFixed(0)}¬∞C</div>
                    <div class="text-sm opacity-90">Dew Point</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üîÜ</div>
                    <div class="text-lg font-bold">${avgUV.toFixed(1)}</div>
                    <div class="text-sm opacity-90">UV Index</div>
                </div>
                <div class="text-center bg-white/10 rounded-xl p-4">
                    <div class="text-3xl mb-2">üìä</div>
                    <div class="text-lg font-bold">${avgPressure.toFixed(0)}hPa</div>
                    <div class="text-sm opacity-90">Pressure</div>
                </div>
            `;

            document.getElementById('weather-summary').innerHTML = weatherSummaryHTML;
        }

        // Generate crop-specific recommendations
        function generateCropRecommendations(cropType, growthStage) {
            const cropData = {
                '1.20': { // Rice
                    name: 'Rice (Paddy)',
                    water: {
                        seedling: 'Keep soil constantly moist (2-3 inches water depth)',
                        vegetative: 'Maintain 2-4 inches water depth, reduce to 1-2 inches during tillering',
                        flowering: 'Critical stage - maintain 2-3 inches water depth'
                    },
                    sunlight: {
                        seedling: 'Partial shade preferred (4-6 hours direct sun)',
                        vegetative: 'Full sun required (6-8 hours daily)',
                        flowering: 'Full sun essential (8+ hours daily)'
                    },
                    tips: 'Rice requires flooded conditions. Monitor water levels daily during critical growth stages.'
                },
                '0.75': { // Wheat
                    name: 'Wheat',
                    water: {
                        seedling: 'Light, frequent watering (0.5-1 inch weekly)',
                        vegetative: 'Moderate watering (1-1.5 inches weekly)',
                        flowering: 'Reduce watering to prevent lodging (0.5-1 inch weekly)'
                    },
                    sunlight: {
                        seedling: 'Full sun required (6-8 hours daily)',
                        vegetative: 'Full sun essential (8+ hours daily)',
                        flowering: 'Full sun critical (8+ hours daily)'
                    },
                    tips: 'Wheat is drought-tolerant. Avoid overwatering during flowering to prevent disease.'
                },
                '1.25': { // Sugarcane
                    name: 'Sugarcane',
                    water: {
                        seedling: 'Consistent moisture (1-2 inches weekly)',
                        vegetative: 'Heavy watering required (2-3 inches weekly)',
                        flowering: 'Maintain high moisture (2-2.5 inches weekly)'
                    },
                    sunlight: {
                        seedling: 'Full sun required (6-8 hours daily)',
                        vegetative: 'Full sun essential (8+ hours daily)',
                        flowering: 'Full sun critical (8+ hours daily)'
                    },
                    tips: 'Sugarcane is water-intensive. Ensure deep soil moisture penetration.'
                },
                '1.15': { // Cotton
                    name: 'Cotton',
                    water: {
                        seedling: 'Light watering (0.5-1 inch weekly)',
                        vegetative: 'Moderate watering (1-2 inches weekly)',
                        flowering: 'Critical watering period (1.5-2 inches weekly)'
                    },
                    sunlight: {
                        seedling: 'Full sun required (6-8 hours daily)',
                        vegetative: 'Full sun essential (8+ hours daily)',
                        flowering: 'Full sun critical (8+ hours daily)'
                    },
                    tips: 'Cotton needs well-drained soil. Avoid water stress during boll development.'
                },
                '1.10': { // Lentils
                    name: 'Lentils (Dal)',
                    water: {
                        seedling: 'Light watering (0.5 inch weekly)',
                        vegetative: 'Moderate watering (0.5-1 inch weekly)',
                        flowering: 'Reduce watering (0.5 inch weekly)'
                    },
                    sunlight: {
                        seedling: 'Full sun preferred (6-8 hours daily)',
                        vegetative: 'Full sun required (6-8 hours daily)',
                        flowering: 'Full sun essential (6-8 hours daily)'
                    },
                    tips: 'Lentils are drought-tolerant. Overwatering can cause root rot.'
                },
                '0.95': { // Coconut
                    name: 'Coconut',
                    water: {
                        seedling: 'Regular watering (1-2 inches weekly)',
                        vegetative: 'Consistent moisture (1.5-2 inches weekly)',
                        flowering: 'Maintain soil moisture (1.5-2 inches weekly)'
                    },
                    sunlight: {
                        seedling: 'Partial shade initially, then full sun',
                        vegetative: 'Full sun required (6-8 hours daily)',
                        flowering: 'Full sun essential (8+ hours daily)'
                    },
                    tips: 'Coconut palms need deep, well-drained soil. Salt tolerance varies by variety.'
                },
                '1.05': { // Tea
                    name: 'Tea',
                    water: {
                        seedling: 'Consistent moisture (1-1.5 inches weekly)',
                        vegetative: 'Regular watering (1-2 inches weekly)',
                        flowering: 'Maintain moisture (1-1.5 inches weekly)'
                    },
                    sunlight: {
                        seedling: 'Partial shade preferred (4-6 hours direct sun)',
                        vegetative: 'Partial shade ideal (4-6 hours direct sun)',
                        flowering: 'Partial shade optimal (4-6 hours direct sun)'
                    },
                    tips: 'Tea prefers acidic soil and partial shade. Avoid waterlogging.'
                }
            };

            const crop = cropData[cropType];
            if (!crop) return null;

            const stageNames = {
                '0.7': 'seedling',
                '1.05': 'vegetative', 
                '0.8': 'flowering'
            };

            const currentStage = stageNames[growthStage] || 'vegetative';

            return {
                name: crop.name,
                water: crop.water[currentStage],
                sunlight: crop.sunlight[currentStage],
                tips: crop.tips
            };
        }

        // Display crop recommendations
        function displayCropRecommendations(recommendations) {
            const container = document.getElementById('crop-recommendations');
            if (!container) return;

            const recommendationsHTML = `
                <div class="nasa-card rounded-xl p-6">
                    <h4 class="text-xl font-bold mb-4" style="color: var(--nasa-blue-yonder);">
                        üíß Water Requirements
                    </h4>
                    <p style="color: rgba(255, 255, 255, 0.9);" class="text-sm leading-relaxed">
                        ${recommendations.water}
                    </p>
                </div>
                <div class="nasa-card rounded-xl p-6">
                    <h4 class="text-xl font-bold mb-4" style="color: var(--nasa-neon-yellow);">
                        ‚òÄÔ∏è Sunlight Requirements
                    </h4>
                    <p style="color: rgba(255, 255, 255, 0.9);" class="text-sm leading-relaxed">
                        ${recommendations.sunlight}
                    </p>
                </div>
                <div class="nasa-card rounded-xl p-6 md:col-span-2">
                    <h4 class="text-xl font-bold mb-4" style="color: var(--nasa-rocket-red);">
                        üå± Expert Tips for ${recommendations.name}
                    </h4>
                    <p style="color: rgba(255, 255, 255, 0.9);" class="text-sm leading-relaxed">
                        ${recommendations.tips}
                    </p>
                </div>
            `;

            container.innerHTML = recommendationsHTML;
        }

        function createEnhancedResultCard(dayIndex, dateString, waterNeeded_inches, precip_mm, et_inches, weatherData, cropCoeff) {
            const year = parseInt(dateString.substring(0, 4));
            const month = parseInt(dateString.substring(4, 6)) - 1;
            const day = parseInt(dateString.substring(6, 8));
            const date = new Date(year, month, day);

            let dayLabel = date.toLocaleDateString('en-IN', { weekday: 'long' });

            const ACRE_IN_SQ_METERS = 4046.86;
            const waterAmount_inches = parseFloat(waterNeeded_inches);
            const waterInLiters = waterAmount_inches * 0.0254 * ACRE_IN_SQ_METERS * 1000;
            const et_mm = et_inches * 25.4;

            // Enhanced farming insights based on comprehensive NASA data
            let farmingAdvice = '';
            let soilMoistureLevel = '';
            let optimalIrrigation = '';
            let diseaseRisk = '';
            let pestActivity = '';
            let growthRecommendation = '';
            
            // Calculate soil moisture index
            const soilMoistureIndex = (weatherData.humidity + (precip_mm * 10) - (et_mm * 2)) / 3;
            
            // Determine farming recommendations based on comprehensive data
            if (waterAmount_inches > 0.1) {
                farmingAdvice = 'üå± Water early morning (5-7 AM) for optimal root absorption';
                soilMoistureLevel = 'Dry - Needs Irrigation';
                optimalIrrigation = `${waterInLiters.toLocaleString()}L`;
                
                if (weatherData.temp_max > 35) {
                    farmingAdvice += ' | ‚ö†Ô∏è High temperature - increase watering frequency';
                }
                if (weatherData.wind_speed > 5) {
                    farmingAdvice += ' | üí® High wind - water closer to plants';
                }
            } else if (precip_mm > 5) {
                farmingAdvice = '‚ö†Ô∏è Check drainage - excess moisture may cause root rot';
                soilMoistureLevel = 'Wet - Monitor Drainage';
                optimalIrrigation = 'Skip Irrigation';
                diseaseRisk = 'High - Fungal diseases likely';
            } else if (weatherData.humidity > 80) {
                farmingAdvice = 'üåø High humidity - reduce irrigation frequency';
                soilMoistureLevel = 'Moist - Reduced Need';
                optimalIrrigation = 'Minimal Water';
                diseaseRisk = 'Moderate - Watch for fungal issues';
            } else {
                farmingAdvice = '‚úÖ Optimal conditions - maintain current schedule';
                soilMoistureLevel = 'Balanced - Monitor';
                optimalIrrigation = 'Regular Check';
            }

            // Pest activity prediction based on weather
            if (weatherData.temp_max > 30 && weatherData.humidity > 70) {
                pestActivity = 'High - Monitor for aphids and mites';
            } else if (weatherData.temp_max < 20) {
                pestActivity = 'Low - Cold weather reduces pest activity';
            } else {
                pestActivity = 'Moderate - Regular monitoring recommended';
            }

            // Growth recommendations
            if (weatherData.temp_max > 35) {
                growthRecommendation = 'üå°Ô∏è Heat stress - provide shade or mulch';
            } else if (weatherData.temp_min < 10) {
                growthRecommendation = '‚ùÑÔ∏è Cold stress - protect young plants';
            } else if (weatherData.uvb > 0.5) {
                growthRecommendation = '‚òÄÔ∏è High UV - consider UV protection';
            } else {
                growthRecommendation = 'üå± Optimal growth conditions';
            }

            let status, amountText, description, reasoningText, bgColor, textColor;

            if (waterAmount_inches > 0.1) {
                status = 'üíß Watering Needed'; 
                bgColor = 'bg-blue-100';
                textColor = 'text-blue-600';
                amountText = `${waterInLiters.toLocaleString('en-IN', { maximumFractionDigits: 0 })} Liters`;
                description = 'per acre';
                reasoningText = 'High NASA-measured solar energy with minimal rain.';
            } else {
                status = '‚úÖ Monitor Only'; 
                bgColor = 'bg-green-100';
                textColor = 'text-green-600';
                amountText = 'No Water Needed';
                if (precip_mm > 2.5) {
                    description = 'Sufficient NASA-tracked Rain';
                    reasoningText = 'NASA precipitation data shows adequate rainfall recorded.';
                } else {
                    description = 'Soil humidity optimal';
                    reasoningText = 'Low solar ET and residual moisture sufficient.';
                }
            }
            
            const enhancedCardHTML = `
                <div class="bg-white p-6 rounded-2xl border-2 border-gray-200 card-hover fade-in ${bgColor}">
                    <div class="mb-4">
                        <h3 class="font-bold text-xl text-gray-800 mb-2">${dayLabel}</h3>
                        <p class="text-sm text-gray-500 mb-3">${date.toLocaleDateString('en-IN', { month: 'short', day: 'numeric' })}</p>
                        <p class="${textColor} font-bold text-2xl mb-2">${amountText}</p>
                        <p class="text-gray-600 font-medium mb-3">${description}</p>
                        <div class="inline-block px-4 py-2 rounded-full text-sm font-semibold ${textColor} bg-white mb-3">
                            ${status}
                        </div>
                        
                        <!-- Enhanced Farming Data -->
                        <div class="mt-3 p-3 bg-gray-50 rounded-lg">
                            <div class="text-sm font-semibold text-gray-700 mb-2">üåæ Farming Insights:</div>
                            <div class="text-xs text-gray-600 mb-1">${farmingAdvice}</div>
                            <div class="text-xs text-gray-600 mb-1">Soil: ${soilMoistureLevel}</div>
                            <div class="text-xs text-gray-600 mb-1">Optimal Water: ${optimalIrrigation}</div>
                            <div class="text-xs text-gray-600 mb-1">Disease Risk: ${diseaseRisk || 'Low'}</div>
                            <div class="text-xs text-gray-600 mb-1">Pest Activity: ${pestActivity}</div>
                            <div class="text-xs text-gray-600">Growth: ${growthRecommendation}</div>
                        </div>
                    </div>
                    
                    <div class="pt-4 border-t border-gray-200">
                        <p class="font-bold text-gray-700 mb-2">üìä NASA Data Analysis:</p>
                        <div class="space-y-1 text-sm text-gray-600">
                            <div>‚òÄÔ∏è Solar Energy (ET): <strong>${et_mm.toFixed(1)} mm</strong></div>
                            <div>üåßÔ∏è Precipitation: <strong>${precip_mm.toFixed(1)} mm</strong></div>
                            <div>üå°Ô∏è Max Temp: <strong>${weatherData.temp_max.toFixed(1)}¬∞C</strong></div>
                            <div>üå°Ô∏è Min Temp: <strong>${weatherData.temp_min.toFixed(1)}¬∞C</strong></div>
                            <div>üí® Wind Speed: <strong>${weatherData.wind_speed.toFixed(1)} m/s</strong></div>
                            <div>üíß Humidity: <strong>${weatherData.humidity.toFixed(1)}%</strong></div>
                            <div>üå´Ô∏è Dew Point: <strong>${weatherData.dew_point.toFixed(1)}¬∞C</strong></div>
                            <div>üìä Pressure: <strong>${weatherData.pressure.toFixed(0)} hPa</strong></div>
                            <div>üîÜ UV Index: <strong>${((weatherData.uva + weatherData.uvb) * 10).toFixed(1)}</strong></div>
                        </div>
                        <p class="mt-2 text-sm text-gray-500 italic">${reasoningText}</p>
                    </div>
                </div>`;
            resultCardsContainer.innerHTML += enhancedCardHTML;
        }
    </script>
</body>
</html>